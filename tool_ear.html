<!DOCTYPE HTML>
<html manifest="manifest">
<head>
<meta charset="UTF-8">
<link href="js/layer_mobile/need/layer.css" type="text/css" rel="stylesheet">
<script src="js/layer_mobile/layer.js"></script>
<script src="js/underscore-min.js"></script>
<script src="js/jquery.js"></script>
<script src="js/exif.js"></script>
<script src="js/jbp.js"></script>
<link rel="stylesheet" type="text/css" href="css/tool.css" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<title>长耳朵、换发型壁纸生成工具</title>
<meta name="keywords" content="长耳朵壁纸,换发型壁纸,iPhone X换发型, iPhone X长耳朵,微信透明, 透明头像, 透明昵称, 透明消息, 圆形头像, 圆形头像生成, 微信二维码名片, 二维码名片, 二维码生成, 微信彩色昵称, QQ彩色昵称, 彩色昵称, 微信昵称小尾巴, 微信小尾巴, 二维码合并, 收款码合并, 花样文字, 花样文字工具, 花样文字生成, 火星文生成, 火星文工具 角标, 微信标记, 小电话号码, 小号码, 电话标记, 随机工具, 今天吃什么, 随机抽取工具, 智能机器人, 公众号工具, 关键词回复工具, 关键词回复超链接, 公众号关键词回复, 微信公众号工具, workflow规则, workflow, 小程序, 小号英文">
<meta name="description" content="煎饼铺，一个有趣的公众号。长耳朵壁纸,换发型壁纸,iPhone X换发型, iPhone X长耳朵,微信透明, 透明头像, 透明昵称, 透明消息, 圆形头像, 圆形头像生成, 微信二维码名片, 二维码名片, 二维码生成, 微信彩色昵称, QQ彩色昵称, 彩色昵称, 微信昵称小尾巴, 微信小尾巴, 二维码合并, 收款码合并, 花样文字, 花样文字工具, 花样文字生成, 火星文生成, 火星文工具 角标, 微信标记, 小电话号码, 小号码, 电话标记, 随机工具, 今天吃什么, 随机抽取工具, 智能机器人, 公众号工具, 关键词回复工具, 关键词回复超链接, 公众号关键词回复, 微信公众号工具, workflow规则, workflow, 小程序, 小号英文">
<script>
var templete = [{
	"id": 1,
	"name": "小熊",
	"svg_path": "M1076.2 246.2A318.5 318.5 0 0 1 1125 416V140a139.7 139.7 0 0 1-48.8 106.2zM48.8 246.2A139.7 139.7 0 0 1 0 140v276a318.5 318.5 0 0 1 48.8-169.8zM274 99.3a322.6 322.6 0 0 1 46-3.3h485a322.6 322.6 0 0 1 46 3.3A140 140 0 0 1 985 0H140a140 140 0 0 1 134 99.3zM0 140A140 140 0 0 1 140 0H0zM985 0a140 140 0 0 1 140 140V0z"
},

{
	"id": 2,
	"name": "小猫",
	"svg_path": "M0 408a318.8 318.8 0 0 1 82-214 294.5 294.5 0 0 1-2-34C80 71.6 118.5 0 166 0c35.4 0 66 40 79 97a320.8 320.8 0 0 1 75-9h485a320.8 320.8 0 0 1 75 9c13-57 43.6-97 79-97 47.5 0 86 71.6 86 160a294.5 294.5 0 0 1-2 34 318.7 318.7 0 0 1 81.5 196.3V-.5H-.5v483H0z"
},

{
	"id": 3,
	"name": "齐刘海儿",
	"svg_path": "M0 0v287.2c0-5.7 0-11.4.3-17 .3-12.3 1-24.6 3.3-36.8a123.3 123.3 0 0 1 11.6-35 118.3 118.3 0 0 1 52-51.3 126.2 126.2 0 0 1 35.4-11.5c12.3-2.2 24.8-3 37.2-3.2 23-.3 30.2-.3 36.8-.3h771.2c26 0 31.7 0 37.4.3 12.4.3 25 1 37.2 3.2a126.2 126.2 0 0 1 35.4 11.6 118.6 118.6 0 0 1 30 21.7 117.2 117.2 0 0 1 22 29.8 122.7 122.7 0 0 1 11.6 35c2.2 12 3 24.4 3.3 36.7.2 5.6.2 11.3.3 17v20V0z"
},

{
	"id": 4,
	"name": "大波浪",
	"svg_path": "M0 0v200a80 80 0 0 1 160 0h.8a80 80 0 1 1 160 0h1a80 80 0 0 1 160 0h.7a80 80 0 0 1 160 0h.8a80 80 0 0 1 160 0h1a80 80 0 0 1 160 0h.7a80 80 0 0 1 160 0V0z"
},
{
	"id": 5,
	"name": "王冠",
	"svg_path": "M0 0v287.2c0-5.7 0-11.4.3-17 .3-12.3 1-24.6 3.3-36.8a123.3 123.3 0 0 1 11.6-35A118.3 118.3 0 0 1 48 159.2V32h200v100h34.5V96h160v36h40V96h160v36h40V96h160v36H877V32h200v127.4a118.6 118.6 0 0 1 10.8 9.5 117.2 117.2 0 0 1 22 29.7 122.7 122.7 0 0 1 11.6 35 236.2 236.2 0 0 1 3.3 36.7c.2 5.6.2 11.3.3 17V0z"
},
{
	"id": 6,
	"name": "小碎花儿",
	"svg_path": "M0 0v112h11.6a46.8 46.8 0 0 1 70.5 0h23.4a46.8 46.8 0 0 1 70.5 0h23a46.8 46.8 0 0 1 70.6 0H293a46.8 46.8 0 0 1 70.4 0h23.2a46.8 46.8 0 0 1 70.5 0h23.4a46.8 46.8 0 0 1 70.5 0h23a46.8 46.8 0 0 1 70.6 0H668a46.8 46.8 0 0 1 70.4 0h23.2a46.8 46.8 0 0 1 70.5 0h23.4a46.8 46.8 0 0 1 70.5 0h23a46.8 46.8 0 0 1 70.6 0h23.3a46.8 46.8 0 0 1 70.4 0h11.6V0z"
},

{
	"id": 7,
	"name": "T恤",
	"svg_path": "M562.5 140c187.8 0 340-62.7 340-140h-680c0 77.3 152.2 140 340 140z"
},
{
	"id": 8,
	"name": "圆领衫",
	"svg_path": "M109.8 0c66 93.2 243.7 160 452.7 160S949.3 93.2 1015.2 0z"
},
{
	"id": 9,
	"name": "背心儿",
	"svg_path": "M0 213C69 188.7 120 102.6 120 0H0zM1005 0c0 102.5 51 188.6 120 213V0zM562.5 220c166.2 0 307.6-91.8 360-220h-720c52.4 128.2 193.8 220 360 220z"
},
{
	"id": 10,
	"name": "心型",
	"svg_path": "M0 0v384C0 220.524 132.524 88 296 88c117.25 0 218.57 68.176 266.5 167.046C610.43 156.176 711.75 88 829 88c163.476 0 296 132.524 296 296V0z"
},
];

// 对图片旋转处理
function rotateImg(img, direction, canvas) {  
        //最小与最大旋转方向，图片旋转4次后回到原方向  
        var min_step = 0;  
        var max_step = 3;  
        //var img = document.getElementById(pid);  
        if (img == null){return; }
        //img的高度和宽度不能在img元素隐藏后获取，否则会出错  
        var height = img.height;  
        var width = img.width;  
        //var step = img.getAttribute('step');  
        var step = 2;  
        if (step == null) {  
            step = min_step;  
        }  
        if (direction == 'right') {  
            step++;  
            //旋转到原位置，即超过最大值  
            step > max_step && (step = min_step);  
        } else {  
            step--;  
            step < min_step && (step = max_step);  
        }  
        //img.setAttribute('step', step);  
        /*var canvas = document.getElementById('pic_' + pid);  
        if (canvas == null) {  
            img.style.display = 'none';  
            canvas = document.createElement('canvas');  
            canvas.setAttribute('id', 'pic_' + pid);  
            img.parentNode.appendChild(canvas);  
        }  */
        //旋转角度以弧度值为参数  
        var degree = step * 90 * Math.PI / 180;  
        var ctx = canvas.getContext('2d');  
        switch (step) {  
            case 0:  
                canvas.width = width;  
                canvas.height = height;  
                ctx.drawImage(img, 0, 0);  
                break;  
            case 1:  
                canvas.width = height;  
                canvas.height = width;  
                ctx.rotate(degree);  
                ctx.drawImage(img, 0, -height);  
                break;  
            case 2:  
                canvas.width = width;  
                canvas.height = height;  
                ctx.rotate(degree);  
                ctx.drawImage(img, -width, -height);  
                break;  
            case 3:  
                canvas.width = height;  
                canvas.height = width;  
                ctx.rotate(degree);  
                ctx.drawImage(img, -width, 0);  
                break;  
        }  
    } 
	    
function modifyImg(file,image,Orientation) {
		// 图片方向角
		var img = image;
		var expectWidth = img.naturalWidth;
		var expectHeight = img.naturalHeight;
		var base64 = null;
		/*if (expectWidth > expectHeight && expectWidth > 1125) {
				expectWidth = 1125;
				expectHeight = expectWidth * expectHeight / expectWidth;
		} else if (expectHeight > expectWidth && expectHeight > 2436) {
			expectHeight = 2436;
			expectWidth = expectHeight * expectWidth / expectHeight;
		}*/
		
		if (expectWidth > 1125) {
			expectWidth = 1125;
		}
		
		if (expectHeight > 2436) {
			expectHeight = 2436;
		}
		
		var canvas = document.createElement("canvas");
		var ctx = canvas.getContext("2d");
		canvas.width = expectWidth;
		canvas.height = expectHeight;

		//document.body.appendChild(canvas);

		//tip(expectWidth+":"+expectHeight);
		ctx.drawImage(img, 0, 0, expectWidth, expectHeight);

		// 修复android
		if (navigator.userAgent.match(/Android/i)) {
			/*var encoder = new JPEGEncoder();
			base64 = encoder.encode(ctx.getImageData(0, 0, expectWidth, expectHeight), 100);*/
			base64 = canvas.toDataURL("image/jpeg");
		// 修复iOS or other
		} else {
			if(Orientation != "" && Orientation != 1){
				//tip('自动旋转处理');
				switch(Orientation){
				 	case 6://需要顺时针（向左）90度旋转
				 		//tip('自动旋转处理，需要顺时针（向左）90度旋转');
				 		rotateImg(img,'left',canvas);
				 		break;
				 	case 8://需要逆时针（向右）90度旋转
				 		//tip('自动旋转处理，需要顺时针（向右）90度旋转');
				 		rotateImg(img,'right',canvas);
				 		break;
				 	case 3://需要180度旋转
				 		//tip('自动旋转处理，需要180度旋转');
						rotateImg(img,'right',canvas);//转两次
						rotateImg(img,'right',canvas);
						break;
				}		
			}
			
			base64 = canvas.toDataURL("image/jpeg");
		}

		return base64;
}

function replaceAll(srcStr, aStr, bStr) {
	srcStr = srcStr.replace(new RegExp(aStr,'gi'), bStr);
	return srcStr;
}

var result="";
var temp = '<label>'+
'	<figure>'+
'		<svg viewBox="0 0 1125 2436">'+
'			<path d="#path">'+
'			</path>'+
'		</svg>'+
'	</figure>'+
'	<span>'+
'#name'+
'	</span>'+
'	<input type="radio" value="#id">'+
'</label>';

function getObjectURL(file) {
    var url = null ; 
    if (window.createObjectURL!=undefined) { // basic
        url = window.createObjectURL(file) ;
    } else if (window.URL!=undefined) { // mozilla(firefox)
        url = window.URL.createObjectURL(file) ;
    } else if (window.webkitURL!=undefined) { // webkit or chrome
        url = window.webkitURL.createObjectURL(file) ;
    }
    return url ;
}
$(function(){ 
	/*for (i=0;i<templete.length;i++) {
		result += replaceAll(temp, "#id", i);
		result += replaceAll(temp, "#name", templete[i][name]);
		result += replaceAll(temp, "#path", templete[i][svg_path]);
	}
	$(".wrap").html(result);*/

});
</script>
</head>
<body>
<div>
<button type="button" style="align:left;background-color:#FFC74A; border-radius:20px;" onclick="back()">返回</button>
</div>
<div id="app">
	<div class="canvas-wrap">
		<canvas width="1125" height="2436">
		</canvas>
	</div>
	<div class="previewer">
		<label class="phone" style="font-size: 30.8116px;">
			<figure  style="background-image: url(img/default.jpg);">
				<svg viewBox="0 0 1125 2436">
					<path d="M109.8 0c66 93.2 243.7 160 452.7 160S949.3 93.2 1015.2 0z">
					</path>
				</svg>
			</figure>
			<input type="file" accept="image/*" hidden="hidden" id="upload">
		</label>
		<p class="tip">
			<span>
				选择好模板后，点击生成图片
			</span>
		</p>
	</div>
	<div class="control">
		<div class="title">
			
			<h3>
				选择模板：
			</h3>
			<button>
				生成壁纸
			</button>
		</div>
		<div class="wrap">
		</div>
	</div>
	<!---->
</div>

  <script src="js/manifest.js?v=180105_2"></script>
  <script src="js/vendor.js?v=180105_2"></script>
  <script src="js/app.js?v=180105_2"></script>
  
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?464d7e308b0fdd9fb407887891784488";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>
</html>