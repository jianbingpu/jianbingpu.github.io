<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<link href="js/layer_mobile/need/layer.css" type="text/css" rel="stylesheet">
<script src="js/layer_mobile/layer.js"></script>
<script src="js/underscore-min.js"></script>
<script src="js/jquery.js"></script>
<script src="js/clipboard.min.js"></script>
<!--<script type="text/javascript" src="http://html2canvas.hertzen.com/build/html2canvas.js"></script>-->
<link rel="stylesheet" type="text/css" href="css/tool.css" />
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<title>煎饼铺,一个有趣的公众号</title>
<script>
$(function() {
    var clipboard = new Clipboard('#copy');

    clipboard.on('success', function(e) {
    	e.clearSelection();
    	tip("拷贝成功");
    });

    clipboard.on('error', function(e) {
    	e.clearSelection();
    	tip("拷贝失败，请手动复制");
    });
    
});
</script>
</head>
<body  oncontextmenu="return false;" onselectstart="return false">
	    <button type="button" style="align:left;background-color:#FFC74A; border-radius:20px;" onclick="back()">返回</button>
	<div id="container">
	<h3>今天吃什么生成工具</h3><hr>
	    <p id="info">
	        1、点击吃什么，快速轮播菜单，点击停止，系统随机选择一个。<br><br>
	        2、点击复制按钮，会复制当前一个滚动菜单，粘贴的时候才会得知是什么。<br><br>
	    </p>
	    <p>输出：<button type="button" style="width:60px;height:22px;font-size:10px;background-color:#4682B4; border-radius:10px;" data-clipboard-target="#output"  id="copy">复制</button></p>
	    <textarea  class="tarea" id="output" readonly style="font-size:70px;line-height:70px;"> </textarea>
	    <br><br><br>
	    <button type="button" style="background-color:#00C74A; border-radius:20px;" id="create">吃什么</button>
	    <button type="button" style="background-color:#4682B4; border-radius:20px;" id="diy">自定义</button>
	    <!--<button type="button" style="background-color:#FF4500; border-radius:20px;"  id="screen" >截屏</button>
	    <a id="down" src="" download="" style="display:none"></a>-->
	</div>
</body>
 <script>
 
 	function back() {
 		this.location.href="gj.html";
 	}
 	
 	function diy() {
 		var cont = '<p id="info">1、手动输入菜单，以空格分隔即可<br>2、点击确定，系统会保存自定义菜单数据</p>';
 		cont += '<textarea  class="tarea" id="menu" ></textarea>';
 		cont += "<br><br>";
 		cont += '<button type="button" style="width:80px;height:30px;background-color:#00C74A; border-radius:20px;" id="addMenu">确定</button>';
 		cont += '<button type="button" style="width:80px;height:30px;background-color:#FF4500; border-radius:20px;" id="clearMenu">清空</button>';
 		pop("自定义菜单", cont);
 		
 		if(!!window.localStorage){
			// 写入菜单
			var diyMenu = localStorage.getItem("jbp_tool_diymenu");
			if (diyMenu != null && diyMenu != undefined) {
        			$("#menu").val(diyMenu.toString().replace(/,/g," ").replace("null",""));
        		} else {
        			$("#menu").val("");
        		}
 		} else {
 			$("#menu").val("");
 		}
 		
 		$("#clearMenu").on("click",function(e){
 			if(!!window.localStorage){
 				// 写入菜单
            		localStorage.setItem("jbp_tool_diymenu","");
            		layer.closeAll();
            		tip("自定义菜单已经清空");
 			} else {
 				layer.closeAll();
 			}
 		});
 		
 		$("#addMenu").on("click",function(e){
 			var menuStr = $("#menu").val();
 			menuStr = menuStr.replace(/ /g," ").replace(/,/g,"")
 			menuStr=$.trim(menuStr);
 			
 			var menuArr = menuStr.split(" ");
 			// 去除数组中间的多余空格
 			for(var i = 0; i<menuArr.length; i++){
 				if ($.trim(menuArr[i]) == "") {
 					menuArr.splice(i,1);
       				i=i-1;
 				}
 			}
 			
 			if (menuArr.length<=1) {
 				tip("请至少输入2个菜单");
 			} else if(!!window.localStorage){
 				// 写入菜单
            		localStorage.setItem("jbp_tool_diymenu", menuArr);
            		layer.closeAll();
            		tip("自定义菜单已经存储");
 			} else {
 				layer.closeAll();
 				tip("你的设备不支持自定义内容");
 			}
 			
	 	 });
 	}
 	
 	function pop(title, msg) {
		 //自定义标题风格
		 layer.open({
		    type: 3,
		    title: [
		     title,
		      'margin-top:0px;border-radius:0px;background-color: #FFC74A; color:#fff;'
		    ]
		    ,content: msg
		    ,time: 0
		    ,btn:"关闭"
		  });
	}
	
 	 var menu;
       var strType=new Array("盖浇饭","砂锅","麻辣香锅","汉堡王","包子","河南烩面","大排档","米粉米线","鸭雪粉丝汤","烙饼卷带鱼","麦当劳","饺子","麻辣烫","煎饼","炒饼炒面","羊蝎子","呷哺呷哺","水煮鱼","馄饨","火锅","烧烤","泡面","肯德基","驴肉火烧","吉野家","味千拉面","鱼头泡饼","面包","肉夹馍凉皮","披萨","山西刀削面","兰州拉面","沙县小吃","烤鱼","海鲜","铁板烧","韩国料理","喝粥","日本料理");
    	 var t;
	 var $result=$("#output");
	 var flg = true;
	 
	  $("#diy").on("click",function(e){
	  	diy();
	  });

	 $("#create").on("click",function(e){
	 	e.preventDefault();
		if (flg) {
			flg = false;
			$('#create').html('停止');
			$('#create').css({"background-color":"#FF4500" ,"border-radius":"20px"});
			start();
		} else {
			flg = true;
			$('#create').html('再来');
			$('#create').css({"background-color":"#00C74A" ,"border-radius":"20px"});
			stop();
		}
        });
       	
      // 循环菜单
	function start() {
		// 确定数据来源
		var menuArr = localStorage.getItem("jbp_tool_diymenu");
		
		if (!!menuArr) {
			menuArr = menuArr.split(",");
			menu = menuArr
		} else {
			menu = strType;
		}
		i = Math.floor(Math.random() * menu.length);
		$result.val(menu[i]);
		t = setTimeout(start, 10);
	}

	// 停止跳动
	function stop() {
		clearTimeout(t);
		if ($result.val()=="") {
			i = Math.floor(Math.random() * menu.length);
			$result.val(menu[i]);
		}
		t = null;
	}
        
        $("#clear").on("click",function(e){
       	e.preventDefault();
      	$("#output").val(' ');
      	tip("已清空");
        });
        
        function tip(msg) {
	          //提示
		  layer.open({
		    content: msg
		    ,skin: 'msg'
		    ,time: 2 //2秒后自动关闭
		  });
	}

	/*$("#screen").on("click",function(e){
                        event.preventDefault();
                        html2canvas(document.body, {
                        allowTaint: true,
                        taintTest: false,
                        onrendered: function(canvas) {
                        canvas.id = "mycanvas";  
                        //document.body.appendChild(canvas);
                        //生成base64图片数据  
                        var dataUrl = canvas.toDataURL();
                       
                        tip("截屏成功，手动保存");
		  	     setTimeout(function () {
                        		window.open(dataUrl);
                        },1000);
                       
                   	//$('#down').attr('href', dataUrl);
		  	   	//$('#down').attr('download', new Date().getTime()+".png");
		  	   	
		  	   	//setTimeout(function () {
		  	   	//	document.getElementById("down").click();
		  	   	//	tip("截屏成功");
		  	   	//},1000);
		  	     //setTimeout(function () {$('#down').trigger('click'); },1000);
                        //var newImg = document.createElement("img");
                        //newImg.src =  dataUrl;
                        //document.body.appendChild(newImg);
                        }
                    });
                });*/
</script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?464d7e308b0fdd9fb407887891784488";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</html>